<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>testando</title>
</head>
<body>
  <h1>testando</h1>


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>te</title>
</head>
<body>
  <h1>te</h1>
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Editor Lopixecodin - Link Personalizado</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: auto; }
  textarea { width: 100%; height: 200px; font-family: monospace; font-size: 14px; }
  input#slugInput { font-family: monospace; }
  #erros { color: red; margin-top: 10px; }
  #linkGerado { margin-top: 20px; color: green; word-break: break-word; }
</style>
</head>
<body>

<h1>Editor Lopixecodin</h1>

<input type="text" id="slugInput" placeholder="Digite seu link personalizado (ex: meusite)" />

<textarea id="editor" placeholder="Cole seu código aqui..."></textarea><br />
<button id="salvar">Salvar no Firestore</button>

<div id="erros"></div>
<div id="linkGerado"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
  import {
    getFirestore, collection, doc, setDoc, getDoc
  } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCWH18dhHz0EBY5cc4wjZ1H6AlO-51sho",
    authDomain: "teste1-66092.firebaseapp.com",
    projectId: "teste1-66092",
    storageBucket: "teste1-66092.firebasestorage.app",
    messagingSenderId: "517435649522",
    appId: "1:517435649522:web:a6826c13b1e2c5062acf6b",
    measurementId: "G-3GVBBV8W7C"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const editor = document.getElementById('editor');
  const slugInput = document.getElementById('slugInput');
  const salvarBtn = document.getElementById('salvar');
  const errosDiv = document.getElementById('erros');
  const linkDiv = document.getElementById('linkGerado');

  function validarCodigo(codigo) {
    if (!codigo.trim()) return ["O código está vazio."];
    // Pode validar mais regras aqui
    return [];
  }

  function validarSlug(slug) {
    if (!slug) return "O campo link personalizado está vazio.";
    if (!/^[a-z0-9\-]+$/.test(slug)) return "Use somente letras minúsculas, números e hífens.";
    return null;
  }

  async function salvarCodigo() {
    errosDiv.innerHTML = '';
    linkDiv.innerHTML = '';

    const conteudo = editor.value.trim();
    const slug = slugInput.value.trim();

    // Validar slug
    const slugError = validarSlug(slug);
    if (slugError) {
      errosDiv.innerText = slugError;
      return;
    }

    // Validar código
    const erros = validarCodigo(conteudo);
    if (erros.length) {
      errosDiv.innerHTML = erros.map(e => `<div>⚠️ ${e}</div>`).join('');
      return;
    }

    // Verificar se slug já existe
    const docRef = doc(db, "links", slug);
    const snap = await getDoc(docRef);
    if (snap.exists()) {
      errosDiv.innerText = `O link "${slug}" já está em uso. Escolha outro.`;
      return;
    }

    try {
      // Salvar slug -> código
      await setDoc(docRef, {
        conteudo,
        criadoEm: new Date()
      });

      // Exibir link para usuário
      const baseUrl = window.location.origin;
      const link = `${baseUrl}/interface.html?slug=${encodeURIComponent(slug)}`;

      linkDiv.innerHTML = `✅ Código salvo com sucesso!<br>Compartilhe seu link:<br><a href="${link}" target="_blank">${link}</a>`;

    } catch (err) {
      errosDiv.innerText = 'Erro ao salvar: ' + (err.message || err);
    }
  }

  salvarBtn.addEventListener('click', salvarCodigo);
</script>

</body>
</html>


          
